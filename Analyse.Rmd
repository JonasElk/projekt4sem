---
title: "Analyse"
author: "Jonas Elkjær"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(tidyverse)
library(ggplot2)
library(tinytex)
library(dplyr)
library(hrbrthemes)
library(viridis)
library(zoo)
library(stringr)
library(ggrepel)
library(pander)
library(broom)
library(dynlm)
library(lmtest)
options(digits = 8)
options(scipen = 999)
rm(list=ls())
```

```{r}
data = read_xlsx("data/data.xlsx")
data = data[-c(1:11),]
#data = data[-c(50:52),]
```

```{r}
C = ts(log(data$c), start = 1971, frequency = 1)
inv = ts(log(data$Ipr_faste), start = 1971, frequency = 1)
ps = ts(log(data$ps), start = 1971, frequency = 1)
W = ts(log(data$W), start = 1971, frequency = 1)
R = ts(log(data$R), start = 1971, frequency = 1)

#OBS på NaNs ved r pga negative værdier - Muligvis plus rente med 7 for at undgå? ændrer det noget?
r = ts(log(data$r+1.21), start = 1971, frequency = 1)

Y = ts(log(data$Y), start = 1971, frequency = 1)
```

#Ct - Rigtig
```{r}
#Bjarke med alle variable
dfm = dynlm(d(C) ~ d(R) + d(W) + L(C))
summary(dfm)

dfm$coefficients
dfm$coefficients[2]*mean(C/R)-dfm$coefficients[3]*mean(C/W)
```

#Investeringer - skal rettes
```{r}
#Bjarke med alle variable - decent?
dfm1 = dynlm(d(inv) ~ d(ps) + ps + Y + d(Y) + r  + L(d(r), 2) + d(r))
summary(dfm1)

#Bjarke med signifikante variable / højest adj r2 - Decent? eller bs
dfm2 = dynlm(d(inv) ~ d(ps) + ps + d(Y) + d(r) + L(d(r), 1))
summary(dfm2)

#Onaran og obst med signifikante variable - bs
dfm3 = dynlm(d(inv) ~ L(d(ps)) + d(ps) + d(Y) + L(d(r)))
summary(dfm3)

#1:1 Bjarke med deres signifikante - kinda bs, ingen signifikans for ps
dfm4 = dynlm(d(inv) ~ ps + Y + d(Y))
summary(dfm4)

#Troels med alle variable - dårlig, forvirrende, 3 gange ps
dfm5 = dynlm(d(inv) ~ d(ps) + L(d(ps)) + d(Y) + L(d(r)) + L(d(inv)) + L(ps) + L(Y) + L(inv))
summary(dfm5)

#Troels med signifikante variable - God? god signifikans på PS, og ikke urealistisk resultat
dfm6 = dynlm(d(inv) ~ d(Y) + L(d(r)) + L(ps) + L(inv))
summary(dfm6)

0.4312830*mean(inv/R)
```
